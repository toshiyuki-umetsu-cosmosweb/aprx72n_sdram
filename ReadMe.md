# 概要

RX72N で SDRAMを使う実験をしたテストコードです。

# 使用ボード

(株)アルファプロジェクト社 AP-RX72N-0Aボード
https://www.apnet.co.jp/product/rx/ap-rx72n-0a.html

オンボードで32MBのSDRAMが載っており、たまたま社内にあったので実験に使用しました。

# 何を見るの？

* 内蔵RAMとSDRAM間で、DMA転送をするだけの単純なプログラムです。
  DMACドライバは FIT dmaca を使用し、CGドライバは使いません。
* 内蔵RAM -> SDRAM DMA転送開始時にLD1(P95)を点灯。DMA転送完了で消灯。
             オシロスコープで信号の H 期間を見れば、かかった時間がわかります。
* SDRAM -> 内蔵RAM DMA転送開始時にLD2(P96)を点灯。DMA転送完了で消灯。
             オシロスコープで信号の H 期間を見れば、かかった時間がわかります。
* デバッグ用入出力で USB-Serial を使用しています。
  転送完了時に、転送レートをUSB-Serialに出力するようにしています。

転送サイズは内蔵RAM2の領域サイズを考え、512KBとしました。

# それで、SDRAMってどうやって使うの？

## 参考資料
Renesas Electronics社のアプリケーションノート 
「RXファミリ SDRAMC を使用したSDRAM のリードライト制御」 R01AN5441JJ0100

## ざっくり

RX-72NについてるSDRAM接続用端子をつなぎます。
その上で、SmartConfiguratorで設定します。
(もちろんハードウェアマニュアル片手に、レジスタを設定するやり方でも使えます)
SmartConfiguratorを使う場合の設定手順は次の通り。

1. クロックタブを開き、SDRAM クロック出力を有効にします。
2. コンポーネントタブを開き、BSCモジュールを追加します。
   こちらはCGドライバを使いました。
3. BSCモジュールの外部バスコントローラ設定で、「使用SDCS」をチェックします。
   チェックするとSDCSタブが増えます。
4. BSCモジュールのアドレス出力端子設定をします。
   ここは回路図と照らし合わせて、結線している端子を設定します。
   AP-RX72N-0A では A16-A19ラインは未接続なので、チェックを外しました。
5. SDRAMのデータシートを片手に、SDCSタブのタイミングパラメータを設定します。

